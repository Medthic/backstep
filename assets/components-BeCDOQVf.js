import{r,j as e}from"./vendor_react-CzjAyk7f.js";import{L as Z,c as Ne,d as Ce,C as we,M as Se,H as ke,I as ye,S as ce}from"./vendor-DSp3NhGL.js";import{f as K,e as Ee,g as _e,s as Ae}from"./vendor_date_utils-6gsGKDtX.js";const Te=()=>{const[n,o]=r.useState(new Date);r.useEffect(()=>{const c=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(c)},[]);const h=c=>c.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});return e.jsx("div",{className:"clock",children:h(n)})},Ie=({onToggle:n})=>{const[o,h]=r.useState(!1),c=()=>{h(!o),n(!o)};return e.jsxs("div",{className:"nav-menu-container",children:[e.jsxs("button",{className:`nav-menu-button ${o?"open":""}`,onClick:c,"aria-label":"Toggle menu",children:[e.jsx("span",{className:"line"}),e.jsx("span",{className:"line"}),e.jsx("span",{className:"line"})]}),o&&e.jsxs("nav",{className:"nav-menu",children:[e.jsx(Z,{to:"/",onClick:c,children:"Home"}),e.jsx(Z,{to:"/edit-assignments",onClick:c,children:"Assignments"}),e.jsx(Z,{to:"/admin",onClick:c,children:"Admin"})]})]})};function De(n){if(n%100>=11&&n%100<=13)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function Fe({date:n}){const o=n?new Date(n):new Date,h=o.toLocaleDateString(void 0,{month:"short"}).toUpperCase(),c=o.getDate(),t=De(c);return e.jsxs("span",{className:"nav-date",children:[h," ",c,e.jsx("sup",{style:{fontSize:"0.5em"},children:t})]})}const ts=()=>{const[n,o]=r.useState(!1);return e.jsx("nav",{className:"navbar",children:e.jsx("div",{className:"navbar-container",children:e.jsxs("div",{className:"navbar-content",children:[e.jsxs("div",{className:"navbar-left",children:[e.jsx(Te,{}),e.jsx(Fe,{})]}),e.jsx(Ie,{onToggle:o})]})})})},Re="https://lhprwuhcbqkdxgpftbmo.supabase.co",Oe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxocHJ3dWhjYnFrZHhncGZ0Ym1vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcxMzg5ODUsImV4cCI6MjA2MjcxNDk4NX0.AH4rkivKT9PK00Ya_CYPxvc_Q2xQtQfzaGNWzc8sszs",v=Ne(Re,Oe),ns=({duration:n=4e3})=>{const[o,h]=r.useState(""),[c,t]=r.useState(!1);return r.useEffect(()=>{const d=async()=>{const{data:j}=await v.from("sliding_messages").select("message").order("created_at",{ascending:!1}).limit(1).single();j&&(h(j.message),t(!0),setTimeout(()=>t(!1),n))};d();const f=v.channel("realtime:sliding_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"sliding_messages"},d).on("postgres_changes",{event:"UPDATE",schema:"public",table:"sliding_messages"},d).subscribe();return()=>{v.removeChannel(f)}},[n]),e.jsx("div",{className:"sliding-message-bar",children:e.jsx("div",{className:`sliding-message${c?" show":""}`,children:o})})},E={CHIEF:{background:"#f2f3f4",color:"#222"},CAPTAIN:{background:"#ce2029",color:"#fff"},LIEUTENANT:{background:"#f9b233",color:"#222"},ENGINEER:{background:"#FFD700",color:"#222"},FIREFIGHTEREMT:{background:"#375365",color:"#dfddc4"},FIREFIGHTER:{background:"#375365",color:"#dfddc4"},FIREFIGHTERMEDIC:{background:"#375365",color:"#dfddc4"},GREENSHIELD:{background:"#6bf178",color:"#222"},EMT:{background:"#2eccca",color:"#222"},PARAMEDIC:{background:"#8e7cc3",color:"#222"}},Me=()=>{const n=["Engine 41","Engine 42","Truck","Rescue","Ambulance 47","Ambulance 48","Ambulance 49"],o=[["CHAUFFEUR","OFFICER","NOZZLE","LAYOUT","FORCIBLE ENTRY","BACKUP"],["CHAUFFEUR","OFFICER","NOZZLE","LAYOUT","FORCIBLE ENTRY","BACKUP"],["CHAUFFEUR","OFFICER","OVM","IRONS","ROOF","CAN"],["CHAUFFEUR","OFFICER","SAFETY","TOOL","CRIB","CRIB"],["STAFF","STAFF"],["STAFF","STAFF"],["STAFF","STAFF"]],[h,c]=r.useState([]),[t,d]=r.useState([]);r.useEffect(()=>{let j=!1;const p=()=>v.from("assignments").select("box, position, member_id").then(({data:m})=>{j||c(m||[])});p(),v.from("memberlist").select("id, name, rank").then(({data:m})=>{j||d(m||[])});const b=v.channel("realtime-assignments").on("postgres_changes",{event:"*",schema:"public",table:"assignments"},()=>{p()}).subscribe();return()=>{j=!0,v.removeChannel(b)}},[]);const f=j=>t.find(p=>p.id===j);return e.jsxs("div",{className:"carousel-page assignment-grid ambulance-layout",children:[n.slice(0,4).map((j,p)=>e.jsxs("div",{className:"assignment-box",children:[e.jsx("h3",{children:j}),o[p].map((b,m)=>{var u,C;const N=h.find(l=>l.box===p&&l.position===m),a=N?f(N.member_id):null;return e.jsxs("div",{className:"assignment-row vertical-align",children:[e.jsx("div",{className:"position-label left-align",children:b}),e.jsx("div",{className:a?`member-selection-box rank-${((u=a.rank)==null?void 0:u.toLowerCase())||"default"}`:"member-selection-box unassigned",style:a&&E[(C=a.rank)==null?void 0:C.toUpperCase()]?{background:E[a.rank.toUpperCase()].background,color:E[a.rank.toUpperCase()].color}:void 0,children:a?e.jsxs("span",{children:[e.jsx("span",{className:"member-name",children:a.name})," ",e.jsx("span",{className:"member-rank",children:a.rank})]}):e.jsx("span",{children:"Unassigned"})})]},m)})]},p)),e.jsx("div",{className:"ambulance-stack",children:n.slice(4).map((j,p)=>e.jsxs("div",{className:"assignment-box ambulance-box",children:[e.jsx("h3",{children:j}),o[p+4].map((b,m)=>{var u,C;const N=h.find(l=>l.box===p+4&&l.position===m),a=N?f(N.member_id):null;return e.jsxs("div",{className:"assignment-row vertical-align",children:[e.jsx("div",{className:"position-label left-align",children:b}),e.jsx("div",{className:a?`member-selection-box rank-${((u=a.rank)==null?void 0:u.toLowerCase())||"default"}`:"member-selection-box unassigned",style:a&&E[(C=a.rank)==null?void 0:C.toUpperCase()]?{background:E[a.rank.toUpperCase()].background,color:E[a.rank.toUpperCase()].color}:void 0,children:a?e.jsxs("span",{children:[e.jsx("span",{className:"member-name",children:a.name})," ",e.jsx("span",{className:"member-rank",children:a.rank})]}):e.jsx("span",{children:"Unassigned"})})]},m)})]},p+4))})]})},Ue={"en-US":Ee},Le=Ce({format:K,startOfWeek:()=>Ae(new Date,{weekStartsOn:0}),getDay:_e,locales:Ue}),Pe="ca0a5ef337ea062aef476550d3c7073c848e8499b2c4a965cc23a7f448ea2bd1@group.calendar.google.com",$e="AIzaSyCCVDsg9pIi8DcGW8S2GvfwuOgHlDVRA1Y";function Be({event:n}){const o=n.allDay,h=o?null:K(n.start,"HH:mm"),c=o?null:K(n.end,"HH:mm");return e.jsxs("span",{style:{fontSize:"0.85rem",lineHeight:1.2},children:[!o&&e.jsxs("span",{style:{fontWeight:500,marginRight:3},children:[h,c&&`-${c} `]}),n.title]})}function He({label:n}){return e.jsx("div",{className:"rbc-toolbar",style:{justifyContent:"center",display:"flex"},children:e.jsx("span",{className:"rbc-toolbar-label",children:n})})}const ze=()=>{const[n,o]=r.useState([]);return r.useEffect(()=>{fetch(`https://www.googleapis.com/calendar/v3/calendars/${Pe}/events?key=${$e}&singleEvents=true&orderBy=startTime`).then(h=>h.json()).then(h=>{if(!h.items)return;const c=h.items.filter(t=>t.start&&(t.start.dateTime||t.start.date)).map(t=>{var d,f;return{id:t.id,title:t.summary,start:new Date(t.start.dateTime||t.start.date),end:new Date(((d=t.end)==null?void 0:d.dateTime)||((f=t.end)==null?void 0:f.date)||t.start.dateTime||t.start.date),allDay:!t.start.dateTime}});o(c)})},[]),e.jsx("div",{className:"carousel-page calendar-page",style:{height:"100%",width:"100%"},children:e.jsx(we,{localizer:Le,events:n,startAccessor:"start",endAccessor:"end",style:{height:"100%",width:"100%"},popup:!0,views:["month"],defaultView:"month",toolbar:!0,components:{event:Be,toolbar:He}})})},We="1g_BfPk42Cy83PTkVGlAyxC3w5g9MUQXVHyO-I7VA2rE",qe="AIzaSyAqBIZ19jFidOeEii80p_EQSzRtBltLwlc",G=async n=>{const o=`https://sheets.googleapis.com/v4/spreadsheets/${We}/values/${n}?key=${qe}`,c=await(await fetch(o)).json();return n==="Status"?c.values?c.values.slice(1):[]:n==="RunStats"?c.values?c.values.slice(1).map(t=>[t[0],t[1]]):[]:c.values?c.values.slice(1).map(t=>[t[0],t[1],t[2]]):[]};function Ve(){const[n,o]=r.useState({departmentNews:[],runStats:[],toolsStatus:[]});r.useEffect(()=>{async function d(){const[f,j,p]=await Promise.all([G("DepartmentNews"),G("RunStats"),G("Status")]);o({departmentNews:f,runStats:j,toolsStatus:p})}d()},[]);const h=d=>{if(!d)return"";const f=d.toLowerCase();return f.includes("in service")?"status-in":f.includes("out")?"status-out":f.includes("maintenance")?"status-maint":"status-other"},c=d=>{const f=d.toLowerCase();return f.includes("fire")?"run-stat-fire":f.includes("ems")?"run-stat-ems":"run-stat-other"},t=d=>{if(!d)return null;const f=d.toLowerCase();return f==="important"?e.jsx(Se,{className:"news-icon important"}):f==="policy change"?e.jsx(ke,{className:"news-icon policy"}):f==="general"?e.jsx(ye,{className:"news-icon general"}):null};return e.jsxs("div",{className:"info-full-container",children:[e.jsxs("div",{className:"info-col",children:[e.jsx("h2",{children:"Department News"}),e.jsx("ul",{children:n.departmentNews.map((d,f)=>{const[j,p,b]=d;return e.jsx("li",{children:e.jsxs("div",{className:"info-item news-item news-flex",children:[e.jsxs("div",{className:"news-content",children:[e.jsx("div",{children:j}),p&&e.jsx("div",{className:"news-date",children:p})]}),e.jsx("div",{className:"news-icon-container",children:t(b)})]})},f)})})]}),e.jsxs("div",{className:"info-col",children:[e.jsx("h2",{children:"Run Statistics"}),e.jsx("div",{className:"run-stats-grid",children:n.runStats.map((d,f)=>{const[j,p]=d;return e.jsxs("div",{className:`run-stat-item ${c(p)}`,children:[e.jsx("div",{className:"run-stat-title",children:p}),e.jsx("div",{className:"run-stat-number",style:{fontWeight:"bold"},children:j})]},f)})})]}),e.jsxs("div",{className:"info-col",children:[e.jsx("h2",{children:"Tools & Equipment Status"}),e.jsx("ul",{children:n.toolsStatus.map((d,f)=>{const[j,p]=d;return e.jsx("li",{children:e.jsxs("div",{className:`info-item status-item ${h(p)}`,children:[e.jsx("span",{className:"status-tool",children:j}),e.jsx("span",{className:"status-label",children:p})]})},f)})})]})]})}const F=[{key:"assignment",node:e.jsx(Me,{},"assignment")},{key:"calendar",node:e.jsx(ze,{},"calendar")},{key:"information",node:e.jsx(Ve,{},"information")}],as=()=>{const[n,o]=r.useState(0),[h,c]=r.useState(!1),[t,d]=r.useState(F.map(a=>a.node)),f=r.useRef(null),j=r.useRef(null),p=700,b=1e4,m=a=>{if(!a)return F.map(l=>l.node);const u=Object.keys(a).filter(l=>a[l]),C=F.filter(l=>u.includes(l.key));return C.length?C.map(l=>l.node):F.map(l=>l.node)};r.useEffect(()=>{let a=null;async function u(){try{const{data:l,error:w}=await v.from("carousel_settings").select("config").limit(1).single();!w&&l&&l.config?d(m(l.config)):d(F.map(_=>_.node))}catch{d(F.map(l=>l.node))}try{a=v.channel("realtime:carousel_settings").on("postgres_changes",{event:"INSERT",schema:"public",table:"carousel_settings"},l=>{var _;const w=(_=l==null?void 0:l.new)==null?void 0:_.config;w&&(d(m(w)),o(0))}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"carousel_settings"},l=>{var _;const w=(_=l==null?void 0:l.new)==null?void 0:_.config;w&&(d(m(w)),o(0))}).subscribe()}catch{}}const C=()=>{try{u()}catch{}};return u(),window.addEventListener("carouselPagesChanged",C),()=>{a&&v.removeChannel(a),window.removeEventListener("carouselPagesChanged",C)}},[]),r.useEffect(()=>((()=>{f.current=setTimeout(()=>{t.length<=1||(c(!0),j.current=setTimeout(()=>{o(u=>(u+1)%t.length),c(!1)},p))},b)})(),()=>{clearTimeout(f.current),clearTimeout(j.current)}),[n,t]);const N=(n+1)%t.length;return e.jsx("div",{className:"carousel",children:e.jsx("div",{className:"carousel-track",children:t.map((a,u)=>{const C=u===n&&!h,l=h&&u===n,w=h&&u===N,P=["carousel-page",C?"active":"",l?"outgoing":"",w?"incoming":"",!C&&!l&&!w?"hidden":""].join(" ").trim();return e.jsx("div",{className:P,children:a},`page-${u}`)})})})},Ye={ENGINE_41:{name:"Engine 41",positions:["Driver","Officer","Nozzle","Backup","Bar","Layout"]},ENGINE_42:{name:"Engine 42",positions:["Driver","Officer","Nozzle","Backup","Bar","Layout"]},TRUCK:{name:"Truck",positions:["Driver","Officer","OVM","Roof","Bar","Can"]},RESCUE:{name:"Rescue",positions:["Driver","Officer","Safety","Crib","Crib","Tool"]}},Ze=[47,48,49].map(n=>({name:`Ambulance ${n}`,positions:["Staff","Staff"]})),Ge=({value:n,onChange:o,options:h,isDisabled:c})=>e.jsx(ce,{className:"member-select",value:h.find(t=>t.value===n)||null,onChange:t=>o((t==null?void 0:t.value)||null),options:h,isClearable:!0,isSearchable:!0,isDisabled:c,styles:{option:(t,d)=>({...t,color:"#222",backgroundColor:d.data.color,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),singleValue:t=>({...t,color:"#222",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"}),valueContainer:t=>({...t,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),menu:t=>({...t,zIndex:9999}),menuList:t=>({...t,maxHeight:"220px"})}}),le=({name:n,positions:o,boxIdx:h,onAssign:c,memberOptions:t,savingMap:d,getAssignment:f})=>e.jsxs("div",{className:"assignment-box",children:[e.jsx("h3",{children:n}),o.map((j,p)=>e.jsxs("div",{className:"assignment-row vertical-align",children:[e.jsx("div",{className:"position-label left-align",children:j}),e.jsx(Ge,{value:f(h,p),onChange:b=>c(h,p,b),options:t,isDisabled:!!d[`${h}-${p}`]})]},p))]}),rs=()=>{const[n,o]=r.useState([]),[h,c]=r.useState([]),[t,d]=r.useState({});r.useEffect(()=>{(async()=>{const[N,a]=await Promise.all([v.from("assignments").select("box, position, member_id"),v.from("memberlist").select("id, name, rank")]);o(N.data||[]),c(a.data||[])})();let m=null;try{m=v.channel("realtime:assignments").on("postgres_changes",{event:"*",schema:"public",table:"assignments"},N=>{const{eventType:a}=N;if(a==="INSERT"||a==="UPDATE"){const u=N.new;o(C=>[...C.filter(w=>!(w.box===u.box&&w.position===u.position)),{box:u.box,position:u.position,member_id:u.member_id}])}else if(a==="DELETE"){const u=N.old;o(C=>C.filter(l=>!(l.box===u.box&&l.position===u.position)))}}).subscribe()}catch{}return()=>{m&&v.removeChannel(m)}},[]);const f=r.useMemo(()=>h.map(b=>{var m;return{value:b.id,label:`${b.name} (${b.rank})`,color:((m=E[b.rank])==null?void 0:m.background)||"#fff"}}),[h]),j=(b,m)=>{var N;return((N=n.find(a=>a.box===b&&a.position===m))==null?void 0:N.member_id)||""},p=async(b,m,N)=>{const a=`${b}-${m}`;d(u=>({...u,[a]:!0}));try{N===null?(await v.from("assignments").delete().eq("box",b).eq("position",m),o(u=>u.filter(C=>!(C.box===b&&C.position===m)))):(await v.from("assignments").upsert({box:b,position:m,member_id:N},{onConflict:["box","position"]}),o(u=>[...u.filter(l=>!(l.box===b&&l.position===m)),{box:b,position:m,member_id:N}]))}catch(u){console.error("Error updating assignment:",u)}d(u=>{const C={...u};return delete C[a],C})};return e.jsx("div",{className:"assignment-edit-page",children:e.jsxs("div",{className:"assignment-grid",children:[Object.values(Ye).map(({name:b,positions:m},N)=>e.jsx(le,{name:b,positions:m,boxIdx:N,onAssign:p,memberOptions:f,savingMap:t,getAssignment:j},N)),e.jsx("div",{className:"ambulance-stack",children:Ze.map(({name:b,positions:m},N)=>e.jsx(le,{name:b,positions:m,boxIdx:N+4,onAssign:p,memberOptions:f,savingMap:t,getAssignment:j,className:"ambulance-box"},N+4))})]})})},is=()=>{const[n,o]=r.useState(""),[h,c]=r.useState(!1),[t,d]=r.useState(""),[f,j]=r.useState(""),[p,b]=r.useState(""),[m,N]=r.useState(""),[a,u]=r.useState(""),[C,l]=r.useState(""),[w,_]=r.useState([]),[P,$]=r.useState(!1),[I,B]=r.useState(null),[J,R]=r.useState(""),[Ke,O]=r.useState(""),[Je,Qe]=r.useState(!1),[T,D]=r.useState({show:!1,message:"",type:""}),[Q,X]=r.useState(()=>{try{return localStorage.getItem("admin_actor")||null}catch{return null}}),[H,de]=r.useState(null),[M,me]=r.useState(null),U={assignment:!0,calendar:!0,information:!0},[ee,L]=r.useState(U),[se,z]=r.useState(null),te=Object.keys(E).map(s=>({value:s,label:s.replace(/([A-Z])/g," $1").trim(),color:E[s].background,textColor:E[s].color})),ne=Object.keys(E);r.useEffect(()=>{h&&v.from("memberlist").select("id, name, rank").then(({data:i})=>_(i||[])),(async()=>{try{const{data:i,error:x}=await v.from("carousel_settings").select("id, config").limit(1).single();!x&&i&&i.config?(L(i.config),z(i.id)):L(U)}catch{L(U),k("Could not load carousel settings from server","error")}})()},[h,C]);const k=(s,i="info",x=2e3)=>{D({show:!0,message:s,type:i}),setTimeout(()=>D({show:!1,message:"",type:""}),x)},ue=()=>{if(M)return M;if(H)return H;if(Q)return Q;try{let s=localStorage.getItem("admin_actor");if(s)return X(s),s;const i=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`anon-${Date.now()}-${Math.floor(Math.random()*1e4)}`;try{localStorage.setItem("admin_actor",i)}catch{}return X(i),i}catch{return null}},S=async(s,i={})=>{try{const x=ue(),g=M||x||null,y={...i,admin:{id:H||null,name:M||x||null}},{error:A}=await v.rpc("insert_admin_audit",{p_actor:g,p_action:s,p_details:y});A&&await v.from("admin_audit").insert([{actor:g,action:s,details:y}])}catch{}},ge=async s=>{s.preventDefault(),d("");try{const{data:i,error:x}=await v.from("admins").select("id, name").eq("passcode",n).limit(1).single();if(x||!i){k("Incorrect passcode.","error"),S("login_failed",{reason:"incorrect_passcode"});return}c(!0),o(""),de(i.id),me(i.name||null),k("Login successful!","success"),S("login",{success:!0,admin:{id:i.id,name:i.name}})}catch{k("Error connecting to server.","error"),S("login_failed",{reason:"server_error"})}},he=async s=>{s.preventDefault(),b("");const{data:i}=await v.from("sliding_messages").select("id").limit(1).single();if(i){const x=i.id,{error:g}=await v.from("sliding_messages").update({message:f}).eq("id",x);g?(k("Failed to update message.","error"),S("update_message_failed",{error:g.message||"unknown"})):(k("Message updated!","success"),S("update_message",{message:f}))}else k("Could not find message row.","error"),S("update_message_failed",{error:"no_message_row"})},fe=async s=>{s.preventDefault(),l("");const{error:i}=await v.from("memberlist").insert([{name:m,rank:a}]);if(i)k("Failed to add member.","error"),S("add_member_failed",{name:m,rank:a,error:i.message||"unknown"});else{k("Member added!","success"),S("add_member",{name:m,rank:a}),N(""),u("");const{data:x}=await v.from("memberlist").select("id, name, rank");_(x||[])}},pe=s=>{B(s),$(!0),R(""),O(""),S("delete_member_initiated",{targetId:s})},[W,ae]=r.useState(null),[re,q]=r.useState(""),[ie,V]=r.useState(""),be=s=>{ae(s.id),q(s.name),V(s.rank)},oe=()=>{ae(null),q(""),V("")},xe=async s=>{const i=w.find(y=>y.id===s);if(!i)return;const x={name:re,rank:ie},{error:g}=await v.from("memberlist").update(x).eq("id",s);g?(k("Failed to update member.","error"),S("edit_member_failed",{id:s,prev:i,attempted:x,error:g.message||"unknown"})):(k("Member updated!","success"),_(y=>y.map(A=>A.id===s?{...A,...x}:A)),S("edit_member",{id:s,prev:i,next:x}),oe())},ve=async s=>{s.preventDefault(),O("");try{const{data:g,error:y}=await v.from("admins").select("id, name").eq("passcode",J).limit(1).single();if(y||!g){k("Incorrect passcode.","error"),S("delete_member_failed",{id:I,reason:"incorrect_passcode"});return}}catch{k("Error connecting to server.","error"),S("delete_member_failed",{id:I,reason:"fetch_passcode_error"});return}const i=w.find(g=>g.id===I)||{id:I},{error:x}=await v.from("memberlist").delete().eq("id",I);x?(k("Failed to delete member.","error"),S("delete_member_failed",{id:I,error:x.message||"unknown"})):(k("Member deleted!","success"),_(w.filter(g=>g.id!==I)),S("delete_member",{target:i})),$(!1),B(null),R(""),O("")},je=()=>{$(!1),B(null),R(""),O(""),S("delete_member_cancelled",{})};return h?e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Admin Page"}),e.jsxs("div",{className:"carousel-settings",children:[e.jsx("h3",{className:"carousel-title",children:"Carousel Pages"}),e.jsx("div",{className:"carousel-toggle-row",children:Object.keys(U).map(s=>e.jsxs("label",{className:"carousel-toggle",children:[e.jsx("input",{type:"checkbox",className:"carousel-checkbox",checked:!!ee[s],onChange:async i=>{const x={...ee,[s]:i.target.checked};L(x);try{if(se){const{data:g,error:y}=await v.from("carousel_settings").update({config:x,updated_at:new Date().toISOString()}).eq("id",se).select();if(y)throw y;!g||Array.isArray(g)&&g.length===0?console.warn("carousel_settings update returned no rows but update succeeded"):console.log("carousel_settings update result:",g)}else{const{data:g,error:y}=await v.from("carousel_settings").insert([{config:x}]).select();if(y)throw y;if(console.log("carousel_settings insert result:",g),g&&g[0]&&g[0].id)z(g[0].id);else try{const{data:A,error:Y}=await v.from("carousel_settings").select("id").limit(1).single();!Y&&A&&A.id?z(A.id):Y&&console.warn("Could not fetch carousel_settings id after insert:",Y)}catch(A){console.warn("Fallback fetch for carousel_settings id failed",A)}}window.dispatchEvent(new Event("carouselPagesChanged")),D({show:!0,message:"Carousel updated",type:"success"}),setTimeout(()=>D({show:!1,message:"",type:""}),1500),S("update_carousel",{config:x})}catch(g){console.error("Failed to save carousel settings",g),D({show:!0,message:"Failed to save",type:"error"}),setTimeout(()=>D({show:!1,message:"",type:""}),2e3)}}}),e.jsx("span",{className:"carousel-slider","aria-hidden":"true"}),e.jsx("span",{className:"carousel-label",children:s.replace(/([A-Z])/g," $1").trim()})]},s))})]}),e.jsxs("form",{onSubmit:he,className:"admin-form",children:[e.jsx("label",{htmlFor:"scrolling-message",children:"Update Scrolling Message:"}),e.jsx("input",{id:"scrolling-message",className:"admin-input",type:"text",value:f,onChange:s=>j(s.target.value),placeholder:"Enter new message"}),e.jsx("button",{type:"submit",className:"admin-button",children:"Update Message"})]}),T.show&&e.jsx("div",{className:`admin-popup ${T.type}`,children:T.message}),e.jsxs("div",{className:"admin-table-container",children:[e.jsx("h2",{style:{marginTop:"0.5rem",marginBottom:"1rem"},children:"Members"}),e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Rank"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[w.slice().sort((s,i)=>{const x=ne.indexOf(s.rank),g=ne.indexOf(i.rank);return x===-1&&g===-1?0:x===-1?1:g===-1?-1:x-g}).map(s=>{var i,x;return e.jsxs("tr",{children:[e.jsx("td",{children:W===s.id?e.jsx("input",{className:"admin-input",value:re,onChange:g=>q(g.target.value)}):s.name}),e.jsx("td",{children:W===s.id?e.jsxs("select",{className:"admin-input",value:ie,onChange:g=>V(g.target.value),children:[e.jsx("option",{value:"",children:"Select rank"}),Object.keys(E).map(g=>e.jsx("option",{value:g,children:g.replace(/([A-Z])/g," $1").trim()},g))]}):e.jsx("span",{style:{background:(i=E[s.rank])==null?void 0:i.background,color:(x=E[s.rank])==null?void 0:x.color,padding:"2px 8px",borderRadius:"0.3em",fontWeight:600,fontFamily:'"BebasNeue", Arial, sans-serif',letterSpacing:"2px"},children:s.rank.replace(/([A-Z])/g," $1").trim()})}),e.jsx("td",{children:W===s.id?e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"admin-button",onClick:()=>xe(s.id),children:"Save"}),e.jsx("button",{className:"admin-button",onClick:()=>oe(),children:"Cancel"})]}):e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"admin-button",onClick:()=>be(s),style:{minWidth:60},children:"Edit"}),e.jsx("button",{className:"admin-button",style:{background:"#ce2029",color:"#fff",minWidth:60,padding:"0.3rem 0.8rem"},onClick:()=>pe(s.id),children:"Delete"})]})})]},s.id)}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{className:"admin-input",type:"text",value:m,onChange:s=>N(s.target.value),placeholder:"New member name",required:!0})}),e.jsx("td",{children:e.jsx(ce,{className:"member-select",options:te,value:te.find(s=>s.value===a)||null,onChange:s=>u(s?s.value:""),isClearable:!0,isSearchable:!0,placeholder:"Select rank",menuPlacement:"top",formatOptionLabel:s=>e.jsx("span",{style:{color:s.textColor,fontWeight:600},children:s.label}),styles:{option:(s,i)=>({...s,backgroundColor:i.data.color,color:i.data.textColor,fontFamily:'"BebasNeue", Arial, sans-serif',letterSpacing:"2px",fontWeight:600}),singleValue:(s,i)=>({...s,color:i.data.textColor,backgroundColor:i.data.color,fontFamily:'"BebasNeue", Arial, sans-serif',letterSpacing:"2px",padding:"2px 8px",borderRadius:"0.3em",fontWeight:600}),control:s=>({...s,backgroundColor:"#fff",color:"#222",border:"1px solid #444",fontFamily:'"BebasNeue", Arial, sans-serif',letterSpacing:"2px",minHeight:"40px"}),menu:s=>({...s,backgroundColor:"#fff",color:"#222"})}})}),e.jsx("td",{children:e.jsx("button",{className:"admin-button",style:{minWidth:80},onClick:fe,disabled:!m||!a,children:"Add"})})]})]})]})]}),P&&e.jsx("div",{className:"admin-modal-backdrop",children:e.jsxs("div",{className:"admin-modal",children:[e.jsx("h3",{children:"Confirm Delete"}),e.jsx("p",{children:"Enter your 4-digit passcode to confirm deletion:"}),e.jsxs("form",{onSubmit:ve,children:[e.jsx("input",{type:"password",inputMode:"numeric",pattern:"\\d{4}",maxLength:4,value:J,onChange:s=>R(s.target.value.replace(/\D/g,"")),className:"admin-input",placeholder:"4-digit passcode",required:!0,autoFocus:!0}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"1rem"},children:[e.jsx("button",{type:"submit",className:"admin-button",style:{background:"#ce2029"},children:"Confirm Delete"}),e.jsx("button",{type:"button",className:"admin-button",onClick:je,children:"Cancel"})]})]})]})}),T.show&&e.jsx("div",{className:`admin-popup ${T.type}`,children:T.message})]}):e.jsxs("div",{className:"admin-container",children:[e.jsx("h1",{className:"admin-title",children:"Admin Login"}),e.jsxs("form",{onSubmit:ge,className:"admin-form",children:[e.jsx("input",{type:"password",inputMode:"numeric",pattern:"\\d{4}",maxLength:4,value:n,onChange:s=>o(s.target.value.replace(/\D/g,"")),placeholder:"4-digit passcode",className:"admin-input",required:!0}),e.jsx("button",{type:"submit",className:"admin-button",children:"Login"})]}),T.show&&e.jsx("div",{className:`admin-popup ${T.type}`,children:T.message})]})};export{rs as A,as as P,ns as S,ts as T,is as a};
